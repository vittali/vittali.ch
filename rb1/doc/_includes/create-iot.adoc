
== Create the My-IoT-Platform service

Before you continue, I recommend the following two video tutorials prepared by IBM:

* https://www.youtube.com/watch?v=vLMX9gyTEr4[An Introduction to the IBM Cloud - Part 1 - YouTube]
* https://www.youtube.com/watch?v=OysQX0VwZEY[An Introduction to the IBM Cloud - Part 2 - YouTube]

and the following documents:

* https://cloud.ibm.com/docs/services/IoT?topic=iot-platform-getting-started[IoT Getting started tutorial]
* https://cloud.ibm.com/docs/services/IoT?topic=iot-platform-connect_devices_apps_gw[Connection information for applications, devices, and gateways]
* https://www.ibm.com/support/knowledgecenter/SSQP8H/iot/platform/devices/device_dev_index.html[Device development]
* https://www.ibm.com/support/knowledgecenter/SSQP8H/iot/platform/reference/guardian/security_policies.html#set_up_policies.html[Configuring security policies]

While this seems to be a lot of effort to go through a getting-started tutorial, I found these documents to be
very clear and informative and I believe it is much easier to follow this tutorial after a least a cursory glance at these links.

On the Bluemix Dashboard, click on `Catalog -> Internet of Things -> Internet of Things Platform`
to create an instance of the IoT Platform service. Choose _My-IoT-Platform_ as name.
 Once the instance has been created, you will get another dashboard:

.The dashboard of the _My-IoT-Platform_ service instance
image::start-iot.png[Git]

=== Generate the IOT Platform access code:

. Click on the _Launch_ button.
. On the IoT Platform Dashboard click on _Apps_, and on the top right corner click on _Generate Api Key_.
. Leave the defaults and click _Generate Key_.
. Copy the API Key and the Authentification Token right now because you won't be able to see the again.

[[akat, IoT Platform access code]]
NOTE: Remember: I refer to this pair of strings (API Key,Authentification Token)
as the _IoT Platform_ access code, see <<table1>>.
We will need it later when we modify the Node-RED flow application template file.
This allows us to access the remote Cloudant database when developing the app locally.

=== Configure connection security

To simplify testing we change the default setting for connection security:

. in the IoT Dashboard, click on `Security -> Connection Security` and edit the _Default Rule_.
. in the _Default_ drop down menu, select _TLS Optional_.

Note that this is not recommended for a production environment.
The reason for this change is that the `mqtt` node.js module we use as test mqtt client doesn't seem to use ssl out of the box
and I wanted to keep things as simple as possible.

See also https://www.ibm.com/support/knowledgecenter/SSQP8H/iot/platform/reference/guardian/security_policies.html#set_up_policies.html[Configuring security policies].

=== Configure Devices

Device type creation and device creation is explained in the tutorial material mentioned at the beginning of this chapter
and I assume you know how to perform the following tasks:

. create a new DeviceType with name _nodejs-client_
. and a device of this type with name _nodejs-client-1_
. click until your are asked to provide a Device Authentication Token.

[[dat, DAT access code]]
NOTE: I refer to this token as _DAT_ access code, see <<table1>>. We will need it later when we
instantiate the mqtt client test program template.

WARNING: as usual, write down the access code, you can't retrieve it from the dashboard once the page is closed.

Your dashboard should now look like this:

.The IoT Platform Dashboard after device creation
image::iot-dashboard.png[IoT Platform Dashboard]

You are now ready to add and modify the application project files. But before we do this, we will
install the required software to run Node-RED locally.
